---
title: 在 Azure HPC 缓存中使用访问策略
description: 如何创建和应用自定义访问策略，以限制对 Azure HPC 缓存中的存储目标的客户端访问
author: ekpgh
ms.service: hpc-cache
ms.topic: how-to
ms.date: 12/28/2020
ms.author: v-erkel
ms.openlocfilehash: 795b194eb7cd31e633128c22ddffe808b32e07da
ms.sourcegitcommit: 7e97ae405c1c6c8ac63850e1b88cf9c9c82372da
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/29/2020
ms.locfileid: "97802400"
---
# <a name="use-client-access-policies"></a>使用客户端访问策略

本文介绍如何为存储目标创建和应用自定义客户端访问策略。

客户端访问策略控制客户端能够连接到存储目标导出的方式。 可以在客户端主机或网络级别控制根 squash 和读/写访问等功能。

访问策略应用于命名空间路径，这意味着可以对 NFS 存储系统中的两个不同的导出使用不同的访问策略。

此功能适用于需要控制不同组的客户端如何访问存储目标的工作流。

如果不需要对存储目标访问进行精细的控制，则可以使用默认策略，或者可以使用额外规则自定义默认策略。

## <a name="create-a-client-access-policy"></a>创建客户端访问策略

使用 Azure 门户中的 " **客户端访问策略** " 页来创建和管理策略。 <!-- is there AZ CLI for this? -->

[!["客户端访问策略" 页的屏幕截图。定义了多个策略，某些策略已展开以显示其规则](media/policies-overview.png)](media/policies-overview.png#lightbox)

每个策略由规则构成。 规则将按从最小的作用域到最大 (主机) 到最大 (默认) 。 应用匹配的第一个规则，并且忽略更高的规则。

若要创建新的访问策略，请单击列表顶部的 " **+ 添加访问策略** " 按钮。 为新的访问策略命名，并输入至少一个规则。

![已填充多个规则的访问策略 "编辑" 边栏选项卡屏幕截图。 单击 "确定" 保存规则。](media/add-policy.png)

本部分的其余部分介绍了可以在规则中使用的值。

### <a name="scope"></a>范围

作用域术语和地址筛选器结合使用，以定义哪些客户端受规则影响。

使用它们指定规则是应用于单个客户端 (主机) 、 (网络) 的 IP 地址范围，还是 (默认) 的所有客户端。

为规则选择适当的 **作用域** 值：

* **主机** -规则适用于单个客户端
* **网络** -规则应用于 IP 地址范围中的客户端
* **默认** -规则适用于所有客户端。

策略中的规则按该顺序进行评估。 客户端装入请求匹配一条规则后，将忽略其他规则。

### <a name="address-filter"></a>地址筛选器

**地址筛选器** 值指定与规则匹配的客户端。

如果将作用域设置为 " **主机**"，则只能在筛选器中指定一个 IP 地址。 对于作用域设置 **默认值**，不能在 " **地址筛选器** " 字段中输入任何 IP 地址，因为默认范围与所有客户端匹配。

指定此规则的 IP 地址或地址范围。 使用 CIDR 表示法 (示例： 0.1.0.0/16) 指定地址范围。

### <a name="access-level"></a>访问级别

设置授予与作用域和筛选器匹配的客户端的权限。

选项为 " **读/写**"、" **只读**" 或 " **无访问**"。

### <a name="suid"></a>SUID

选中 " **SUID** " 框，以允许存储中的文件在访问时设置用户 id。

SUID 通常用于临时增加用户的特权，使用户能够完成与该文件相关的任务。

### <a name="submount-access"></a>Submount 访问

选中此复选框可允许指定的客户端直接装载此导出的子目录。

### <a name="root-squash"></a>根 squash

选择是否为与此规则匹配的客户端设置根 squash。

此值允许在存储导出级别允许根 squash。 还可以 [在缓存级别设置根 squash](configuration.md#configure-root-squash)。

如果启用 root squash，则还必须将 "匿名 ID" 用户值设置为以下选项之一：

* **-2** (没有人) 
* **65534** (没有人) 
* **-1** (无权访问) 
* **65535** (无权访问) 
* **0** (非特权根) 

## <a name="update-access-policies"></a>更新访问策略

您可以在 " **客户端访问策略** " 页中编辑或删除表中的访问策略。

单击策略名称以将其打开以进行编辑。

若要删除策略，请在列表中标记其名称旁边的复选框，然后单击列表顶部的 " **删除** " 按钮。 不能删除名为 "default" 的策略。

> [!NOTE]
> 无法删除正在使用的访问策略。 请从包含该策略的任何命名空间路径中删除该策略，然后再尝试将其删除。

## <a name="next-steps"></a>后续步骤

* 在存储目标的命名空间路径中应用访问策略。 请参阅 [设置聚合命名空间](add-namespace-paths.md) 以了解操作方法。
