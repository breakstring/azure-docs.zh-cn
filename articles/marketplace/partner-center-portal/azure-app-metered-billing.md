---
title: 使用 marketplace 计量服务的托管应用程序的计费计费 |Azure Marketplace
description: 本文档介绍了如何使用灵活的计费模式为 Isv 发布 Azure 应用程序。
ms.service: marketplace
ms.subservice: partnercenter-marketplace-publisher
ms.topic: conceptual
ms.date: 04/22/2020
ms.author: mingshen
author: mingshen-ms
ms.openlocfilehash: d015cec30e516541b50c2acfac38fad898965e1b
ms.sourcegitcommit: 5e5a0abe60803704cf8afd407784a1c9469e545f
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/01/2020
ms.locfileid: "96436345"
---
# <a name="managed-application-metered-billing"></a>托管应用程序计费计费 

利用 Marketplace 计量服务，可以为根据非标准单元收费的 Azure 应用程序产品/服务创建托管应用程序计划。 在发布此产品/服务之前，需要定义计费维度，如带宽、票证或处理的电子邮件。 然后，客户根据他们对这些维度的消耗付费。  当计费事件发生时，系统将通过 Marketplace 计量服务 API 通知 Microsoft。

## <a name="prerequisites-for-metered-billing"></a>计费计费的先决条件

为了使托管应用程序计划使用按流量计费，必须执行以下操作：

* 满足 [创建 Azure 应用程序产品/服务](../create-new-azure-apps-offer.md)中所述的所有产品/服务要求。
* 为客户提供服务的每月费用，配置 **定价** 。 如果你不想收取固定费用，而是完全依赖于计费计费，则价格可以为零。
* 为客户将按平整费率支付的计量事件设置 **计费尺寸** 。
* 与 [Marketplace 计量服务 api](./marketplace-metering-service-apis.md) 集成，通知 Microsoft 计费事件。

## <a name="how-metered-billing-fits-in-with-pricing"></a>按计费计费的计费方式

当涉及到定义产品/服务的定价模型时，必须了解产品/服务层次结构。

* 每个 Azure 应用程序产品/服务可以具有解决方案模板或托管应用程序计划。
* 按流量计费仅在托管应用程序计划中实现。
* 每个托管应用程序计划都有一个与之关联的定价模型。 
* 定价模型具有每月周期性费用，可将其设置为 $0。
* 除了定期收费以外，该计划还可以包括用于对客户进行计费的可选维度，而不包括在平整费率中。 每个维度表示你的服务将使用 [Marketplace 计量服务 API](marketplace-metering-service-apis.md)与 Microsoft 通信的计费单位。

## <a name="sample-offer"></a>示例产品

例如，Contoso 是一个发布者，其中包含名为 Contoso Analytics (CoA) 的托管应用程序服务。 CoA 允许客户分析大量数据以便进行报告和数据仓库。 Contoso 注册为 "合作伙伴中心" 中的发布者，以便向 Azure 客户发布产品/服务。 有两个与 CoA 关联的计划，如下所述：

* 基本计划
    * 分析 100 GB 并生成每月 $ 0 个100报表
    * 超过 100 GB，每 1 GB 支付 $10
    * 超过100个报告，为每个报告支付 $1
* 高级计划
    * 分析 1000 GB 并生成每月 $ 350 的1000报表
    * 超过 1000 GB，每 1 TB 支付 $100
    * 超过1000个报告，为每个报告支付 $0。5

订阅 CoA 服务的 Azure 客户可以根据所选计划每月分析和生成报告。 Contoso 会衡量所含数量的使用量，而不会向 Microsoft 发送任何使用事件。 当客户消耗的数量超过所含数量时，无需更改计划或执行其他任何操作。 Contoso 将衡量超出所含数量的超额，并向 Microsoft 开始向 Microsoft 发送使用情况事件，以使用 [Marketplace 计量服务 API](./marketplace-metering-service-apis.md)进行其他使用。 Microsoft 将根据发布者指定的额外使用量向客户收取费用。

## <a name="billing-dimensions"></a>计费维度

计费维度用于向客户传达有关使用软件的计费方式。  这些维度还用于向 Microsoft 传达使用情况事件。 它们的定义如下：

* **维度标识符**：发出使用事件时引用的不可变标识符。
* **维度名称**：与维度关联的显示名称，例如 "已发送短信"。
* **度量单位**：计费单位的说明，例如，"每短信" 或 "每100封电子邮件"。
* **每单位价格**：维度的一个单位的价格。
* **每月期限的包含数量**：每月每月要支付每月费用的客户的维度数量，必须是整数。

在产品/服务的所有计划中共享计费维度。 某些属性适用于所有计划中的维度，其他属性则是特定于计划的。

定义维度本身的属性在产品/服务的所有计划中共享。 在发布产品/服务之前，从任何计划的上下文中对这些属性所做的更改将影响所有计划的维度定义。 发布产品/服务后，将无法再编辑这些属性。 这些属性为：

* 标识符
* 名称
* 度量单位

维度的其他属性特定于每个计划，并且可以有不同于计划的值。  在发布计划之前，你可以编辑这些值，只有此计划会受到影响。 发布计划后，这些属性将不再可编辑。 这些属性为：

* 每个单位的价格
* 每月客户的已包含数量 
* 年度客户的已包含数量 

维度还具有两个特殊概念： "enabled" 和 "无限大"：

* "**已启用**" 指示此计划参与此维度。  如果创建的新计划不基于此维度发送使用情况事件，则可能需要取消选中此选项。 此外，在首次发布计划后添加的任何新维度在已发布的计划中都将显示为 "未启用"。  对于客户所见的计划，禁用的维度不会显示在任何维度列表中。
* **无限**，用无穷符号 "∞" 表示，指示此计划参与此维度，而不会对此维度使用按流量计费。 如果要向客户指示此维度所表示的功能包含在计划中，但没有使用限制。  具有无限使用量的维度将显示在由客户查看的计划的维度列表中。  此计划永远不会产生费用。

>[!Note] 
>明确支持以下方案：  <br> -可以将新维度添加到新计划。  对于任何已发布的计划，将不启用新维度。 <br> -您可以使用固定的每月费用和不含任何维度发布计划，然后添加新计划并为该计划配置一个新维度。 不会为已发布的计划启用新维度。

## <a name="constraints"></a>约束

### <a name="locking-behavior"></a>锁定行为

与 Marketplace 计量服务一起使用的维度表示了解客户将如何为服务付费。  发布产品/服务后，维度的所有详细信息将不再可编辑。  在发布产品/服务之前，请务必完全定义维度。

使用维度发布产品/服务后，将无法再更改该维度的产品/服务详细信息：

* 标识符
* 名称
* 度量单位

发布计划后，将无法再更改计划级别的详细信息：

* 每个单位的价格
* 每月期限的已包含数量
* 是否为计划启用维度

>[!Note]
>Azure 政府版云目前尚不支持使用 marketplace 计量服务的计费计费。

### <a name="upper-limits"></a>上限

单个产品/服务可配置的最大维度数量为30个唯一维度。

## <a name="get-support"></a>获取支持

如果你有以下问题之一，你可以打开支持票证。

* Marketplace 计量服务 API 的技术问题。
* 由于您的端 (错误或错误而需要升级的问题（例如）。 用法事件) 错误。
* 与计费计费相关的任何其他问题。

按照对 [合作伙伴中心中的 "商业市场" 计划的支持](../support.md) 中的说明，了解发布者支持选项并与 Microsoft 建立支持票证。

## <a name="next-steps"></a>后续步骤

- 有关详细信息，请参阅 [Marketplace 计量服务 api](./marketplace-metering-service-apis.md) 。
