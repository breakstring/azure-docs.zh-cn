---
title: 内置和自定义警报列表
description: 了解使用 Defender for IoT 功能和服务的安全警报及建议的修正措施。
services: defender-for-iot
ms.service: defender-for-iot
documentationcenter: na
author: shhazam-ms
manager: rkarlin
editor: ''
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 1/25/2021
ms.author: shhazam
ms.openlocfilehash: c09b6f29e0faa84a708ff04ab08b78ad6bdae95d
ms.sourcegitcommit: 4784fbba18bab59b203734b6e3a4d62d1dadf031
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/08/2021
ms.locfileid: "99809229"
---
# <a name="defender-for-iot-security-alerts"></a>Defender for IoT 安全警报

Defender for IoT 使用高级分析和威胁智能来持续分析 IoT 解决方案，在存在恶意活动时发出警报。
此外，你可以根据对预期设备行为的了解来创建自定义警报。
该警报用作潜在危害指标，应进行调查和修正。

在本文中，你将找到内置警报列表，这些警报可在 IoT 中心和 IoT 设备上触发。
除内置警报外，借助 Defender for IoT 还可以根据预期 IoT 中心和/或设备行为定义自定义警报。
有关详细信息，请参阅[可自定义的警报](concept-customizable-security-alerts.md)。

## <a name="agent-based-security-alerts"></a>基于代理的安全警报

| 名称 | 严重性 | 数据源 | 说明 | 建议的修正步骤 |
|--|--|--|--|--|
| 高严重性 |  |  |  |
| 二进制命令行 | 高 | 经典安全模块 | 检测到正在从命令行调用/执行的 LA Linux 二进制文件。 此过程可能是合法活动，或者表明设备遭到入侵。 | 与运行命令的用户一起查看该命令，检查该命令是否可在设备上合法运行。 否则，请将警报上报给信息安全团队。 |
| 禁用防火墙 | 高 | 经典安全模块 | 检测到有人可能对主机上的防火墙进行了操作。 恶意参与者通常会在尝试盗取数据时禁用主机上的防火墙。 | 与运行命令的用户一起查看该命令，确认这是否是设备上的合法预期活动。 否则，请将警报上报给信息安全团队。 |
| 端口转发检测 | 高 | 经典安全模块 | 检测到有人启动了对外部 IP 地址的端口转发。 | 与运行该命令的用户一起检查这是否是你预期在设备上运行的合法活动。 否则，请将警报上报给信息安全团队。 |
| 检测到有人可能尝试禁用审核日志记录 | 高 | 经典安全模块 | Linux 审核系统提供了一种方法来跟踪系统上与安全相关的信息。 该系统尽可能多地记录了系统事件的相关信息。 此信息对于任务关键型环境非常重要，可以确定违反安全策略的人员及其执行的操作。 禁用审核日志记录可能妨碍你发现系统上使用的安全策略的违反行为。 | 请与设备所有者核实这是否是出于商业原因的合法活动。 如果不是，则此事件可能是恶意参与者的隐藏活动。 请立即将事件上报给你的信息安全团队。 |
| 反向 shell | 高 | 经典安全模块 | 设备的主机数据分析检测到潜在的反向 shell。 反向 shell 通常用于让被入侵的计算机回调到由恶意参与者控制的计算机中。 | 与运行该命令的用户一起检查这是否是你预期在设备上运行的合法活动。 否则，请将警报上报给信息安全团队。 |
| 成功的 Bruteforce 尝试 | 高 | 经典安全模块 | 识别出多个不成功的登录尝试，最终成功登录。 在设备上尝试的 Bruteforce 攻击可能已成功。 | 查看设备上的 SSH Bruteforce 警报和活动。 <br>如果活动为恶意活动：<br> 请向遭到入侵的帐户推出密码重置。<br> 调查设备中的恶意软件并修正（如果找到）。 |
| 本地登录成功 | 高 | 经典安全模块 | 检测到有人成功在本地登录设备 | 请确保已登录的用户是授权方。 |
| Web shell | 高 | 经典安全模块 | 检测到可能存在 Web shell。 恶意参与者通常会将 Web shell 上传到被入侵的计算机以实现持久入侵，从而进一步地盗用计算机。 | 与运行该命令的用户一起检查这是否是你预期在设备上运行的合法活动。 否则，请将警报上报给信息安全团队。 |
| 中等严重性 |  |  |  |
| 检测到与常见的 Linux 机器人类似的行为 | 中 | 经典安全模块 | 检测到有人执行了通常与常见的 Linux 僵尸网络有关的进程。 | 与运行该命令的用户一起检查这是否是你预期在设备上运行的合法活动。 否则，请将警报上报给信息安全团队。 |
| 检测到与 Fairware 勒索软件类似的行为 | 中 | 经典安全模块 | 使用主机数据分析检测到有人针对可疑的位置执行了 rm -rf 命令。 由于 rm -rf 以递归方式删除文件，因此通常用于离散的文件夹。 在这种情况下，它会在可能删除大量数据的位置中使用。 我们知道，Fairware 勒索软件会在此文件夹中执行 rm -rf 命令。 | 与运行该命令的用户一起检查这是否是你预期在设备上运行的合法活动。 否则，请将警报上报给信息安全团队。 |
| 检测到与勒索软件类似的行为 | 中 | 经典安全模块 | 执行类似于已知勒索软件的文件，这种勒索软件可能阻止用户访问系统或个人文件，并可能要求支付赎金才能恢复正常访问。 | 与运行该命令的用户一起检查这是否是你预期在设备上运行的合法活动。 否则，请将警报上报给信息安全团队。 |
| 检测到加密硬币挖掘器容器映像 | 中 | 经典安全模块 | 检测到正在运行已知数字货币挖掘映像的容器。 | 1.如果不希望出现这种情况，请删除相关的容器映像。<br> 2.请确保无法通过不安全的 TCP 套接字访问 Docker 守护程序。<br> 3.请将警报上报给信息安全团队。 |
| 加密硬币挖掘器映像 | 中 | 经典安全模块 | 检测到有人执行了通常与数字货币挖掘关联的进程。 | 与运行该命令的用户一起验证这是否是设备上的合法活动。 否则，请将警报上报给信息安全团队。 |
| 检测到对 nohup 命令的可疑使用 | 中 | 经典安全模块 | 检测到主机上对 nohup 命令的可疑使用。 恶意参与者通常从临时目录运行 nohup 命令，从而有效地允许其可执行文件在后台运行。 对临时目录中的文件运行此命令不是预期或正常的行为。 | 与运行该命令的用户一起检查这是否是你预期在设备上运行的合法活动。 否则，请将警报上报给信息安全团队。 |
| 检测到对 useradd 命令的可疑使用 | 中 | 经典安全模块 | 在设备上检测到对 useradd 命令的可疑使用。 | 与运行该命令的用户一起检查这是否是你预期在设备上运行的合法活动。 否则，请将警报上报给信息安全团队。 |
| 由 TCP 套接字公开的 Docker 守护程序 | 中 | 经典安全模块 | 计算机日志指示 Docker 守护程序 (dockerd) 公开了一个 TCP 套接字。 默认情况下，启用 TCP 套接字时，Docker 配置不会使用加密或身份验证。 默认 Docker 配置向任何有权访问相关端口的人授予 Docker 守护程序的完全访问权限。 | 与运行该命令的用户一起检查这是否是你预期在设备上运行的合法活动。 否则，请将警报上报给信息安全团队。 |
| 本地登录失败 | 中 | 经典安全模块 | 检测到失败的设备本地登录尝试。 | 请确保没有任何未授权方具有对设备的物理访问权限。 |
| 检测到自已知恶意来源的文件下载 | 中 | 经典安全模块 | 检测到自已知恶意来源的文件下载。 | 与运行该命令的用户一起检查这是否是你预期在设备上运行的合法活动。 否则，请将警报上报给信息安全团队。 |
| 检测到对 htaccess 文件的访问 | 中 | 经典安全模块 | 主机数据分析检测到有人可能对 htaccess 文件进行了操作。 Htaccess 是一个功能强大的配置文件，使用该文件，可对运行 Apache Web 软件的 Web 服务器进行多项更改，包括基本的重定向功能以及更高级的功能，例如基本密码保护。 恶意参与者通常会在已遭入侵的计算机上修改 htaccess 文件，以实现持久入侵。 | 请确认这是主机上合法的预期活动。 否则，请将警报上报给信息安全团队。 |
| 已知攻击工具 | 中 | 经典安全模块 | 检测到通常涉及恶意用户以某种方式攻击其他计算机的工具。 | 与运行该命令的用户一起检查这是否是你预期在设备上运行的合法活动。 否则，请将警报上报给信息安全团队。 |
| 已尝试 IoT 代理，但未能分析模块孪生配置 | 中 | 经典安全模块 | 由于配置对象中的类型不匹配，Defender for IoT 安全代理无法解析模块孪生配置 | 针对 IoT 代理配置架构验证模块孪生配置，修复所有不匹配项。 |
| 检测到本地主机侦查 | 中 | 经典安全模块 | 检测到有人执行了通常与常见的 Linux 机器人侦查有关的命令。 | 查看可疑的命令行，确认它是由合法用户执行的。 否则，请将警报上报给信息安全团队。 |
| 脚本解释器与文件扩展名不匹配 | 中 | 经典安全模块 | 检测到脚本解释器和作为输入提供的脚本文件的扩展不匹配。 这种类型的不匹配通常与攻击者脚本执行相关联。 | 与运行该命令的用户一起检查这是否是你预期在设备上运行的合法活动。 否则，请将警报上报给信息安全团队。 |
| 检测到可能存在后门程序 | 中 | 经典安全模块 | 已下载可疑文件，并在订阅中的主机上运行。 这种类型的活动通常与安装后门程序有关。 | 与运行该命令的用户一起检查这是否是你预期在设备上运行的合法活动。 否则，请将警报上报给信息安全团队。 |
| 检测到可能存在数据丢失 | 中 | 经典安全模块 | 使用主机数据分析检测到可能存在数据流出的情况。 恶意参与者通常会从已遭入侵的计算机中泄露数据。 | 与运行该命令的用户一起检查这是否是你预期在设备上运行的合法活动。 否则，请将警报上报给信息安全团队。 |
| 常见文件的潜在替代活动 | 中 | 经典安全模块 | 在设备上覆盖常见可执行文件。 众所周知，恶意参与者会覆盖公用文件，以隐藏其行为或实现持久入侵。 | 与运行该命令的用户一起检查这是否是你预期在设备上运行的合法活动。 否则，请将警报上报给信息安全团队。 |
| 检测到特权容器 | 中 | 经典安全模块 | 计算机日志指示有特权 Docker 容器正在运行。 特权容器对主机的资源具有完全访问权限。 如果遭到入侵，恶意参与者可以使用特权容器获取对主机的访问权限。 | 如果容器无需在特权模式下运行，请从容器中删除权限。 |
| 检测到删除了系统日志文件 | 中 | 经典安全模块 | 检测到主机上可疑的日志文件删除。 | 与运行该命令的用户一起检查这是否是你预期在设备上运行的合法活动。 否则，请将警报上报给信息安全团队。 |
| 文件名后面的空格 | 中 | 经典安全模块 | 使用主机数据分析检测到有人执行了具有可疑扩展名的进程。 可疑扩展可能会诱使用户认为打开文件是安全的，并且可能表明系统上存在恶意软件。 | 与运行该命令的用户一起检查这是否是你预期在设备上运行的合法活动。 否则，请将警报上报给信息安全团队。 |
| 检测到可疑的恶意凭据访问工具 | 中 | 经典安全模块 | 检测到有人使用了通常与恶意尝试访问凭据有关的工具。 | 与运行该命令的用户一起检查这是否是你预期在设备上运行的合法活动。 否则，请将警报上报给信息安全团队。 |
| 检测到可疑的编译 | 中 | 经典安全模块 | 检测到可疑的编译。 恶意参与者通常会在已入侵的计算机上编译利用漏洞的内容以提升特权。 | 与运行该命令的用户一起检查这是否是你预期在设备上运行的合法活动。 否则，请将警报上报给信息安全团队。 |
| 下载了可疑文件，然后执行了文件运行活动 | 中 | 经典安全模块 | 主机数据分析检测到已下载并在同一命令中运行的文件。 恶意参与者通常使用这一技术将已感染病毒的文件转移到目标计算机上。 | 与运行该命令的用户一起检查这是否是你预期在设备上运行的合法活动。 否则，请将警报上报给信息安全团队。 |
| 可疑的 IP 地址通信 | 中 | 经典安全模块 | 检测到与可疑 IP 地址的通信。 | 请验证连接是否合法。 请考虑阻止与可疑 IP 的通信。 |
| 低严重性 |  |  |  |
| 已清空 Bash 历史记录 | 低 | 经典安全模块 | 已清空 Bash 历史记录日志。 恶意参与者通常会擦除 bash 历史记录，以隐藏自己的命令，使其不会出现在日志中。 | 与运行该命令的用户一起检查该警报中的命令，判断该活动是否为合法管理活动。 否则，请将警报上报给信息安全团队。 |
| 设备无提示 | 低 | 经典安全模块 | 设备在过去 72 小时内未发送任何遥测数据。 | 请确保设备已联机并正在发送数据。 检查 Azure 安全代理是否正在设备上运行。 |
| 失败的 Bruteforce 尝试 | 低 | 经典安全模块 | 识别出多个失败的登录尝试。 设备上可能的 Bruteforce 攻击尝试失败。 | 查看设备上的 SSH Bruteforce 警报和活动。 无需进一步操作。 |
| 将本地用户添加到一个或多个组 | 低 | 经典安全模块 | 将新的本地用户添加到此设备上的组。 对用户组进行更改并不常见，这可能表明恶意参与者正在收集额外的权限。 | 请验证更改是否与受影响用户所需的权限一致。 如果更改不一致，请上报给信息安全团队。 |
| 从一个或多个组删除本地用户 | 低 | 经典安全模块 | 已从一个或多个组删除本地用户。 已知恶意参与者会使用此方法尝试拒绝合法用户的访问或删除其操作的历史记录。 | 请验证更改是否与受影响用户所需的权限一致。 如果更改不一致，请上报给信息安全团队。 |
| 检测到本地用户删除 | 低 | 经典安全模块 | 检测到删除了本地用户。 删除本地用户并不常见，恶意参与者可能试图拒绝合法用户的访问或删除其操作的历史记录。 | 请验证更改是否与受影响用户所需的权限一致。 如果更改不一致，请上报给信息安全团队。 |

## <a name="built-in-alerts-for-iot-hub"></a>IoT 中心的内置警报

| 严重性 | 名称 | 说明 | 建议的补救措施 |
|--|--|--|--|
| 中等严重性 |  |  |  |
| 将新证书添加到 IoT 中心 | 中 | 名为 \'%{DescCertificateName}\' 的证书已添加到 IoT 中心 \'%{DescIoTHubName}\'。 如果此操作是由未授权方执行的，则可能表明存在恶意活动。 | 1.请确保证书由授权方添加。 <br> 2.如果该证书不是由授权方添加的，请删除该证书并将警报上报给组织安全团队。 |
| 从 IoT 中心删除证书 | 中 | 名为 \'%{DescCertificateName}\' 的证书已从 IoT 中心 \'%{DescIoTHubName}\' 中删除。 如果此操作是由未授权方执行的，则可能表明存在恶意活动。 | 1.请确保证书已由授权方删除。 <br> 2.如果该证书不是由授权方删除的，请添加回该证书并将警报上报给组织安全团队。 |
| 检测到将证书添加到 IoT 中心的尝试失败 | 中 | 尝试将证书 \'%{DescCertificateName}\' 添加到 IoT 中心 \'%{DescIoTHubName}\' 失败。 如果此操作是由未授权方执行的，则可能表明存在恶意活动。 | 请确保仅向授权方授予更改证书的权限。 |
| 检测到从 IoT 中心删除证书的尝试失败 | 中 | 尝试从 IoT 中心 \'%{DescIoTHubName}\' 删除证书 \'%{DescCertificateName}\' 失败。 如果此操作是由未授权方执行的，则可能表明存在恶意活动。 | 请确保仅向授权方授予更改证书的权限。 |
| x.509 设备证书指纹不匹配 | 中 | x.509 设备证书指纹与配置不匹配。 | 查看设备上的警报。 无需进一步操作。 |
| x.509 证书已过期 | 中 | X.509 设备证书已过期。 | 这可能是证书过期的合法设备，也可能是一次模拟合法设备的尝试。 如果合法设备当前通信正确，这可能是一次模拟尝试。 |
| 低严重性 |  |  |  |
| 检测到尝试添加或编辑 IoT 中心的诊断设置 | 低 | 检测到尝试添加或编辑 IoT 中心的诊断设置。 通过诊断设置，可以在发生安全事件或网络遭到入侵时重新创建活动线索，以用于调查目的。 如果此操作不是由授权方执行的，则可能表明存在恶意活动。 | 1.请确保证书已由授权方删除。<br> 2.如果该证书不是由授权方删除的，请添加回该证书并将警报上报给信息安全团队。 |
| 检测到尝试从 IoT 中心删除诊断设置 | 低 | %{DescAttemptStatusMessage}\' 尝试添加或编辑 IoT 中心 \'%{DescIoTHubName}\' 的诊断设置 \'%{DescDiagnosticSettingName}\'。 通过诊断设置，可以在发生安全事件或网络遭到入侵时重新创建活动线索，以用于调查目的。 如果此操作不是由授权方执行的，则可能表明存在恶意活动。 | 请确保仅向授权方授予更改诊断设置的权限。 |
| SAS 令牌已过期 | 低 | 设备使用的 SAS 令牌已过期 | 可能是令牌过期的合法设备，也可能是一次模拟合法设备的尝试。 如果合法设备当前通信正确，这可能是一次模拟尝试。 |
| SAS 令牌签名无效 | 低 | 设备使用的 SAS 令牌具有无效的签名。 签名与主密钥或辅助密钥不匹配。 | 查看设备上的警报。 无需进一步操作。 |


## <a name="next-steps"></a>后续步骤

- Defender for IoT 服务[概述](overview.md)
- 了解如何[访问安全数据](how-to-security-data-access.md)
- 详细了解如何[调查设备](how-to-investigate-device.md)
